# local dev compose (db only)
version: "3.5"
name: "ytaudio dev"
services:
  postgres:
    image: timescale/timescaledb:latest-pg15
    container_name: db_pg_dev
    env_file: ./api/config/.env
    volumes:
      - pg_data_vol:/var/lib/postgresql/data
    ports:
      - ${DJANGO_DATABASE_PORT:-5432}:5432
#    command: -p 5433
    networks:
      - net-dev

#  amqp:
#    image: rabbitmq:3.8.2-management
#    ports:
#      - ${APP_AMQP_PORT:-5672}:5672
#      - ${APP_AMQP_GUI_PORT:-15672}:15672
#
#  balancer:
#    image: nginx:1.17.8
#    network_mode: host
#    volumes:
#      - ./nginx/develop.template:/etc/nginx/conf.d/default.template:ro
#    command: /bin/bash -c "envsubst '$${API_LOC},$${GUI_LOC},$${WS_LOC}' < /etc/nginx/conf.d/default.template > /etc/nginx/conf.d/default.conf && exec nginx -g 'daemon off;'"
#    environment:
#      - API_LOC=${APP_API_LOC:-http://127.0.0.1:8000}
#      - GUI_LOC=${APP_GUI_LOC:-http://127.0.0.1:3000}
#      - WS_LOC=${APP_GUI_LOC:-http://127.0.0.1:8080}

volumes:
  pg_data_vol: { }

networks:
  net-dev:
    driver: bridge
